# 📖 用户使用手册

**Encrypted Signal Sharing Pool** 完整使用指南

---

## 📋 目录

1. [快速开始](#快速开始)
2. [连接钱包](#连接钱包)
3. [提交信号](#提交信号)
4. [查看聚合结果](#查看聚合结果)
5. [查看贡献和收益](#查看贡献和收益)
6. [常见问题](#常见问题)

---

## 🚀 快速开始

### 前置准备

1. **安装钱包扩展**
   - [MetaMask](https://metamask.io/) 或 [OKX Wallet](https://www.okx.com/web3)
   - 确保钱包已安装并设置完成

2. **获取测试网 ETH**
   - 切换到 **Sepolia 测试网**
   - 从 [Sepolia Faucet](https://sepoliafaucet.com/) 获取测试 ETH

3. **访问应用**
   - 打开应用网址（Netlify 部署链接）
   - 确认网络已切换到 Sepolia

---

## 🔌 连接钱包

### 步骤 1：点击连接按钮

1. 打开应用后，在页面顶部找到 **"Connect Wallet"** 按钮
2. 点击按钮

### 步骤 2：选择钱包

1. 如果你的浏览器安装了 MetaMask，会自动弹出 MetaMask 连接请求
2. 如果没有，会显示支持的钱包列表：
   - MetaMask
   - OKX Wallet
   - 其他 EIP-1193 兼容钱包

### 步骤 3：授权连接

1. 在钱包弹窗中选择要连接的账户
2. 点击 **"连接"** 或 **"Connect"**
3. 授权连接请求

### 步骤 4：切换网络

如果当前网络不是 Sepolia，需要切换：

1. 钱包会提示切换到 Sepolia 网络
2. 点击 **"切换网络"** 或 **"Switch Network"**
3. 确认网络切换

### ✅ 连接成功

连接成功后，你会看到：
- ✅ 钱包地址显示在顶部栏（例如：`0x1234...5678`）
- ✅ "Connect Wallet" 按钮变为 "Disconnect"
- ✅ 可以开始使用所有功能

---

## 📊 提交信号

### 进入信号输入页面

1. 在左侧导航栏点击 **"Signal Input"**（信号输入）
2. 或直接在主界面找到信号输入卡片

### 填写信号信息

#### 1. 选择信号类型

从下拉菜单选择信号类型：
- **Price Prediction**（价格预测）- 预测未来价格
- **Volatility Estimate**（波动率估算）- 估算市场波动
- **Buy/Sell Vote**（买卖投票）- 买入或卖出建议

#### 2. 输入信号值

- 在 **"Signal Value"** 输入框中输入数值
- 根据信号类型输入相应范围的值
- 例如：价格预测可以是 `100`，波动率可以是 `0.5`

#### 3. 设置权重（可选）

- 权重用于加权聚合计算
- 默认值为 `1`
- 范围：`1` - `100`
- 高质量信号可以设置更高权重

### 提交信号

1. 点击 **"Contribute Encrypted Signal"**（提交加密信号）按钮

2. **加密过程**（FHE 模式）：
   - 系统会在你的设备上加密信号
   - 显示 "Encrypting..." 进度动画
   - 加密完成后自动提交到区块链

3. **确认交易**：
   - 钱包会弹出交易确认窗口
   - 检查 Gas 费用
   - 点击 **"确认"** 或 **"Confirm"**

4. **等待确认**：
   - 交易提交后等待区块确认（通常 1-2 秒）
   - 确认后会显示成功消息和 Signal ID

### ✅ 提交成功

提交成功后，你会看到：
- ✅ 成功消息：`Signal #X contributed successfully!`
- ✅ 交易哈希（可以点击查看）
- ✅ 表单自动清空，可以继续提交

---

## 📈 查看聚合结果

### 进入聚合仪表板

1. 在左侧导航栏点击 **"Aggregation Dashboard"**（聚合仪表板）
2. 这是应用的主页面，默认显示

### 查看可用信号

在页面顶部会显示所有可用的加密信号：
- 🔒 **加密信号卡片**：每个信号显示为带锁图标的卡片
- 📋 **信号信息**：信号 ID、类型、贡献者、时间戳
- ✨ **你的信号**：你贡献的信号会有特殊标记（紫色边框）

### 创建聚合

#### 步骤 1：选择聚合类型

从下拉菜单选择：
- **Mean**（均值）- 计算所有信号的平均值
- **Weighted Mean**（加权平均）- 根据权重计算加权平均

#### 步骤 2：选择信号

1. 在多选框中选择要聚合的信号
2. 可以选择多个信号（建议 2 个以上）
3. 选中的信号会在下方显示

#### 步骤 3：设置收益金额（可选）

- 在 **"Revenue (ETH)"** 输入框中输入 ETH 金额
- 这个金额会作为聚合的收益，后续可以分配
- 如果留空，聚合不会有收益（仅用于测试）

#### 步骤 4：创建聚合

1. 点击 **"Create Aggregation"**（创建聚合）按钮
2. 确认交易（在钱包中）
3. 等待交易确认

#### FHE 模式下的解密（如果启用）

1. 交易确认后，系统会自动开始 Gateway 解密轮询
2. 会显示解密进度
3. 解密完成后，结果会显示在图表中

### 查看聚合结果

#### 图表展示

- **折线图**：显示聚合结果随时间的变化
- **两种类型**：均值（蓝色）和加权平均（紫色）
- **交互式**：可以悬停查看具体数值

#### 聚合列表

页面下方会显示所有历史聚合：
- 聚合 ID
- 聚合类型
- 聚合结果（解密后的数值）
- 参与的信号数量
- 创建时间
- 收益金额

---

## 💰 查看贡献和收益

### 进入贡献追踪页面

1. 点击左侧导航栏的 **"Contribution Tracking"**（贡献追踪）

### 查看统计信息

页面顶部显示关键统计：

- **Your Signals**（你的信号数量）
  - 显示你贡献的信号数量 / 总信号数
- **Contribution**（贡献度百分比）
  - 你的信号占所有信号的比例
- **Your Revenue**（你的收益）
  - 已获得的 ETH 收益
- **Total Pool Revenue**（总池收益）
  - 整个池的总收益金额

### 查看可视化图表

#### 1. 贡献雷达图

- 展示你在多个维度的贡献：
  - Signal Count（信号数量）
  - Accuracy（准确度）
  - Contribution %（贡献百分比）
  - Revenue Share（收益份额）

#### 2. 贡献对比柱状图

- 对比你和整体池的：
  - 信号数量
  - 收益金额

### 刷新数据

点击 **"Refresh Data"**（刷新数据）按钮更新最新统计信息。

---

## 💵 收益分配

### 进入收益分配页面

1. 点击左侧导航栏的 **"Revenue Distribution"**（收益分配）

### 查看收益信息

页面显示：
- **Your Total Revenue**（你的总收益）
- **Available to Withdraw**（可提取金额）
- **Revenue History**（收益历史记录）

### 分配聚合收益

#### 步骤 1：选择聚合

1. 点击 **"Distribute Revenue"**（分配收益）按钮
2. 在弹出的对话框中选择聚合 ID
3. 对话框会显示：
   - 聚合的收益金额
   - 是否已分配
   - 是否可以分配

#### 步骤 2：确认分配

1. 选择可分配的聚合（有收益且未分配）
2. 点击 **"Distribute Revenue"** 按钮
3. 在钱包中确认交易

#### 步骤 3：等待确认

- 交易确认后，收益会自动分配给所有参与者
- 你的份额会根据你的贡献度自动计算
- 可以立即在 "Your Revenue" 中看到更新

---

## ⚙️ 设置

### 进入设置页面

点击左侧导航栏的 **"Settings"**（设置）

### 查看配置信息

#### 1. 钱包连接状态

- 显示当前连接状态
- 显示连接的钱包地址
- 显示当前网络（应该是 Sepolia）

#### 2. 网络设置

- Sepolia Chain ID: `11155111`
- RPC URL: Sepolia RPC 地址
- Gateway URL: Zama Gateway 地址

#### 3. 合约配置

- **Current Mode**（当前模式）：
  - Mock（明文测试模式）
  - FHE（加密模式）
- 显示 Mock 和 FHE 合约地址
- 显示当前使用的合约地址

#### 4. 功能设置

- **FHE Encryption Mode**（FHE 加密模式开关）
  - 可以在 Mock 和 FHE 模式之间切换
  - ⚠️ 注意：切换后需要刷新页面

---

## ❓ 常见问题

### Q1: 为什么我的信号显示为加密状态？

**A**: 这是正常的！在 FHE 模式下，所有信号值都是加密存储的。只有聚合结果会被解密。这是隐私保护的核心特性。

### Q2: 如何查看我提交的信号值？

**A**: 为了保护隐私，个体的信号值永远保持加密。只有聚合结果会被解密显示。这是设计的一部分，确保策略不被泄露。

### Q3: 为什么看不到聚合结果？

**A**: 可能的原因：
1. **FHE 模式**：需要等待 Gateway 解密（可能需要几分钟）
2. **没有选择信号**：确保在创建聚合时选择了信号
3. **网络问题**：检查网络连接和 RPC 状态

### Q4: 如何获得收益？

**A**: 
1. 贡献高质量信号
2. 参与聚合（你的信号被选中）
3. 在聚合中添加 ETH 收益
4. 创建聚合的人可以触发收益分配

### Q5: 为什么交易失败？

**A**: 常见原因：
1. **Gas 不足**：确保钱包有足够的 Sepolia ETH
2. **网络错误**：检查是否在 Sepolia 网络
3. **合约错误**：检查输入是否有效（如信号 ID 是否存在）

### Q6: 可以在主网使用吗？

**A**: 当前版本仅支持 Sepolia 测试网。主网部署需要：
- 在主网部署合约
- 配置主网 Gateway（如果有）
- 更新前端配置

### Q7: Mock 模式和 FHE 模式有什么区别？

**A**:
- **Mock 模式**：信号以明文存储，用于快速测试和开发
- **FHE 模式**：信号完全加密，真正的隐私保护，需要 Gateway 解密

### Q8: 如何切换模式？

**A**:
1. 进入 Settings（设置）页面
2. 找到 "FHE Encryption Mode" 开关
3. 切换开关
4. 确认后刷新页面

---

## 🔒 隐私和安全

### 你的数据如何被保护？

1. **端到端加密**：信号在离开你的设备前就已加密
2. **链上加密存储**：区块链上只存储加密数据
3. **同态计算**：聚合计算在加密状态下进行
4. **选择性解密**：只有聚合结果被解密

### 谁可以看到我的信号？

- ❌ **其他用户**：无法看到你的信号值
- ❌ **区块链浏览器**：只能看到加密数据
- ❌ **智能合约**：只能处理加密数据
- ✅ **只有你**：可以在提交前看到自己的信号值

### 收益分配是否公平？

- 基于信号贡献度自动计算
- 所有计算逻辑公开透明
- 可以在链上验证分配结果

---

## 📞 获取帮助

如果遇到问题：

1. **查看文档**：检查本文档的常见问题部分
2. **检查控制台**：打开浏览器开发者工具查看错误信息
3. **联系支持**：通过项目 GitHub Issues 提交问题

---

## 📝 更新日志

### v0.1.0 (2025-01)
- ✅ 初始版本发布
- ✅ 支持信号提交和聚合
- ✅ Mock 和 FHE 双模式
- ✅ 收益分配功能
- ✅ 完整的用户界面

---

**最后更新**: 2025-01-XX  
**版本**: 1.0.0

---

<div align="center">

**享受隐私保护的交易信号聚合体验！** 🔐📊

如有问题，欢迎反馈！

</div>

